<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>Tetra Jasmine Spec Runner</title>
  <link rel="stylesheet" type="text/css" href="javascripts/lib/jasmine/jasmine.css">
  <script type="text/javascript" src="javascripts/lib/jasmine/jasmine.js"></script>
  <script type="text/javascript" src="javascripts/lib/jasmine/jasmine-html.js"></script>
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
  <script type="text/javascript" src="../lib/deps/json2.js"></script>
  <script type="text/javascript" src="../lib/deps/requirejs/require.js"></script>
  <script type="text/javascript" src="../lib/tetra.js"></script>
  <script type="text/javascript" src="../lib/mod/require/client.js"></script>
  <script type="text/javascript" src="../lib/mod/tmpl/client-micro-tmpl.js"></script>
  <script type="text/javascript" src="../lib/tetra-view.js"></script>
  <script type="text/javascript" src="../lib/tetra-controller.js"></script>
  <script type="text/javascript" src="../lib/tetra-model.js"></script>
  <script type="text/javascript">
  // Overriding some globals for the purposes of the tests. 
  //
  // Note: pay particular attention to the DIR paths at the bottom of the file

  (function(){

      "use strict";

      var VNS = (typeof VNS === 'undefined') ? {} : VNS;

      VNS.context = {
          scriptsVersion : "test"
      };
      VNS.util = {
          AjaxPopupBox : function(name, args) {
              this.init = true;
          }
      };
      VNS.misc = {
          helper : {
          // Nothing to do
          }
      };
      VNS.os = {};

      // Setup the tetra default values
      tetra.extend({
      conf : {
        env : 'jQuery',
        jsVersion : VNS.context.scriptsVersion,
        authCallback : function() {
          tns.ajaxBox = new VNS.util.AjaxPopupBox(
              '/r/account/authentication/', {
                callback : 'tns.currentRequest',
                allowEscape : false,
                popupVar : 'tns.ajaxBox'
          });
        },
        currentRequestCallback : function() {
          if (tns.ajaxBox) {
            tns.ajaxBox.close();
          }
        },
        enableBootnode : true,
        APPS_PATH : window.location.href.replace('runner.html', '') + 'javascripts/specs/fixtures/bootstrap',
        GLOBAL_PATH : window.location.href.replace('runner.html', '') + 'javascripts/specs/fixtures/global'
      }
    }).start();

      // Enable debug mode, with a random string to suppress console messages
      tetra.debug.enable("blarg");
      
      // Override the requirejs onError, to prevent 404 load exceptions in the console
      requirejs.onError = function(err) {
          if(err.requireType === "scripterror") {
              if (typeof console !== "undefined") {
                  console.warn("Requirejs failed to load the module(s)", err.requireModules, "with error", err);
              }
          } else {
              throw err;
          }
      };
  })();
  </script>
  <script type="text/javascript" src="javascripts/lib/Sinon.JS/sinon-1.4.2.js"></script>
  <script type="text/javascript" src="javascripts/lib/Sinon.JS/sinon-ie-1.4.2.js"></script>
  <script type="text/javascript" src="javascripts/lib/jasmine/lib/jasmine-jquery.js"></script>
  <script type="text/javascript">
  if(typeof jasmine !== "undefined") {
    jasmine.getFixtures().fixturesPath = 'javascripts/specs/fixtures';
  }
  </script>
  <script type="text/javascript" src="javascripts/lib/utils.js"></script>
  <script type="text/javascript" src="javascripts/specs/tetra.spec.js"></script>
  <script type="text/javascript" src="javascripts/specs/model/tetra.class.spec.js"></script>
  <script type="text/javascript" src="javascripts/specs/controller/tetra.ctrl.spec.js"></script>
  <script type="text/javascript" src="javascripts/specs/view/tetra.bootnode.spec.js"></script>
  <script type="text/javascript" src="javascripts/specs/view/tetra.templating.spec.js"></script>
  <script type="text/javascript" src="javascripts/specs/view/tetra.view.spec.js"></script>
  <script type="text/javascript" src="javascripts/specs/view/underscore.ui.spec.js"></script>
  <script type="text/javascript">
    (function() {
      var jasmineEnv = jasmine.getEnv();
      jasmineEnv.updateInterval = 1000;

      var htmlReporter = new jasmine.HtmlReporter();

      jasmineEnv.addReporter(htmlReporter);

      jasmineEnv.specFilter = function(spec) {
        return htmlReporter.specFilter(spec);
      };

      var currentWindowOnload = window.onload;

      window.onload = function() {
        if (currentWindowOnload) {
          currentWindowOnload();
        }
        execJasmine();
      };

      function execJasmine() {
        jasmineEnv.execute();
      }

    })();
  </script>
</head>
<body>
</body>
</html>